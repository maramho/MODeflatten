set confirm off
set pagination off
set logging on

file /home/dongho.lee/MODeflattener/MODeflattener/ll_file/cfg.O0.flatten_binary
break main
run < input.txt

# ASLR 비활성화 및 최적화 해제
set disable-randomization on
set environment LD_BIND_NOW 1

# 🔥 최적화 방지
set print asm-demangle on
set verbose on
set follow-fork-mode child

# 🧪 state 변수 정보 출력
p &state
p state

# ✅ state 감시 설정 (레지스터 및 메모리 모두 추적)
watch state
rwatch state
awatch state

# 📍 변경 사항 출력
commands
    silent
    printf "📍 [DEBUG] state 변경 감지: %d (주소: %p)\n", state, &state
    bt
    info registers
    continue
end

continue
set logging off
quit
